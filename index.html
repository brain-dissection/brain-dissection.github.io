<!DOCTYPE html>
<html>

<head>
    <!-- Adapted from Dave Epstein's BlogGAN webpage template: https://dave.ml/blobgan/ -->
    <title>Brain Dissection: fMRI-trained Networks Reveal Spatial Selectivity in the Processing of Natural Images</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <style>
        html,
        body,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: "Titillium Web", "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;}
        .cite { padding:0px; background:#ffffff; font-size:18px}
        .card {border: 1px solid #ccc}
        /* img { margin-bottom:-6px;} */
        p { font-size:18px;}
    </style>
    <meta charset="UTF-8">
    <meta name="description" content="Brain Dissection: fMRI-trained Networks Reveal Spatial Selectivity in the Processing of Natural Images">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#f5ece5">
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#276FBF">
    <meta name="msapplication-TileColor" content="#276FBF">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <style>

        html,
        body {
            font-family: 'GT Ultra', sans-serif !important;
            font-weight: 200;
            font-size: 18px;
            overflow-x: hidden;
            box-sizing: border-box;
            color: #1f1e1d;
            background-color: #f5ece5;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit;
        }

        header {
            text-align: center;
        }

        a {
            /* color: #276FBF !important; */
            color: #276FBF;
            text-decoration: none;
            font-weight: 300;
        }

        a:hover {
            text-decoration: underline;
            /* color: #184477 !important; */
            color: #184477;
        }

        section h3 {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        section h5,
        section h3 {
            justify-content: space-between;

            display: flex;
            align-items: center;
        }
    </style>

    <style>
        .outer {
        width: 100%;
        height: 200px;
        background-color: red;
        }
        
        .inner {
        position: relative;
        /* width: 500px;
        height: 300px; */
        /* width: 1124px;
        height: 512px; */
        width: 100%;
        /* height: 300px; */
        text-align: center;
        margin: auto;
        /* top: 25px;
        left: 100px; */
        /* background-image: url("images/best_cat_per_unit_subject1.png"); */
        /* background-color: blue; */
        color: white;
        cursor: crosshair;
        user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        }
        
        .log {
        position: relative;
        width: 100%;
        text-align: center;
        }
    </style>

    <style>
        .project-links {
        /* width: 400px;
        height: 400px;
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        justify-content: center; */
        max-width: 600px;
        margin: 0 auto;
        align-items: center;
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
        }
    </style>

    <!-- Paper button -->
    <style>

        .btn-paper {
        width: 95px;
        height: 35px;
        cursor: pointer;
        border-radius: 25px;
        background: transparent;
        border: 2px solid #91C9FF;
        outline: none;
        transition: 1s ease-in-out;
        text-decoration:none;
        align-items: center;
        display: flex;
        text-align: center;
        font-weight: 500;
        color: black;
        }

        .btn-paper:hover {
        transition: 0.75s ease-in-out;
        background: #8bb2ff1e;
        text-decoration:none;
        font-weight: 500;
        color: black;
        }

        .vertical-center-paper {
            height: 80%;
            position: relative;
            /* top: 0px;
            right: 0;
            float: left; */
            padding-right: 1px;
            padding-left: 6px;
        }

    </style>

    <!-- Code button -->
    <style>
        .btn-code {
            width: 95px;
            height: 35px;
            cursor: pointer;
            border-radius: 25px;
            background: transparent;
            border: 2px solid #91C9FF;
            outline: none;
            transition: 1s ease-in-out;
            text-decoration:none;
            align-items: center;
            display: flex;
            text-align: center;
            font-weight: 500;
            color: black;
        }
    
        .btn-code:hover {
            transition: 0.75s ease-in-out;
            background: #8bb2ff1e;
            text-decoration:none;
            font-weight: 500;
        }

        .vertical-center-code {
            height: 60%;
            position: relative;
            /* top: 0px;
            left: 0px;
            float: left; */
            padding-right: 8px;
            padding-left: 10px;
        }
    
    </style>

    <!-- Citation button -->
    <style>
        .btn-citation {
            width: 110px;
            height: 35px;
            cursor: pointer;
            border-radius: 25px;
            background: transparent;
            border: 2px solid #91C9FF;
            outline: none;
            transition: 1s ease-in-out;
            text-decoration:none;
            align-items: center;
            display: flex;
            text-align: center;
            font-weight: 500;
            color: black;
        }
        .btn-citation:link {
            color: black;
        }
        .btn-citation:visited {
            color: black;
        }
        /* .btn-citation:hover {
            color: black;
        } */
        .btn-citation:active {
            color: black;
        }
    
        .btn-citation:hover {
            transition: 0.75s ease-in-out;
            background: #8bb2ff1e;
            text-decoration:none;
            font-weight: 500;
            color: black;
        }

        .vertical-center-cit {
            height: 70%;
            position: relative;
            /* top: 0px;
            right: 0;
            float: left; */
            padding-right: 7px;
            padding-left: 6px;
        }
        
    </style>

    <style>
        .vertical-center {
            height: 80%;
            position: relative;
            top: 0px;
            right: 0;
            float: left;
        }
    </style>

    <style>
        /* The grid: Four equal columns that floats next to each other */
        .column {
        float: left;
        width: 25% !important;
        padding: 10px;
        }

        /* Style the images inside the grid */
        .column img {
        opacity: 0.8;
        cursor: pointer;
        }

        .column img:hover {
        opacity: 1;
        }

        /* Clear floats after the columns */
        .row:after {
        content: "";
        display: table;
        clear: both;
        }

        /* The expanding image container (positioning is needed to position the close button and the text) */
        .container {
        position: relative;
        display: none;
        }

        /* Expanding image text */
        #imgtext {
        position: absolute;
        bottom: 15px;
        left: 15px;
        color: white;
        font-size: 20px;
        }

        /* Closable button inside the image */
        .closebtn {
        position: absolute;
        top: 10px;
        right: 15px;
        color: white;
        font-size: 35px;
        cursor: pointer;
        }

        .centered {
        position: relative;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: rgb(0, 0, 0);
        background-color: rgba(0, 0, 0, 0.26);
        }

        .text-block {
        position: absolute;
        /* bottom: 25px;
        right: 20px; */
        transform: translate(-50%, -50%);
        top: 50%;
        left: 50%;
        background-color: rgba(0, 0, 0, 0.26);
        color: white;
        padding-left: 30px;
        padding-right: 30px;
        }

        .parentContainer {
        position: relative;
        text-align: center;
        color: white;
        }
    </style>
</head>

<body class="w3-white">
    <!-- Page Container -->
    <div class="w3-content w3-margin-top w3-margin-bottom" style="max-width:960px;">

        <!-- The Grid -->
        <div class="w3-row-padding">

            <!-- paper container -->
            <div class="w3-display-container w3-row w3-white w3-margin-bottom">
                <div class="w3-center">
                    <h2>Brain Dissection: fMRI-trained Networks Reveal Spatial Selectivity in the Processing of Natural Images</h2>
                    <h5><a href="https://www.gabesarch.me">Gabriel Sarch</a> &emsp;&emsp; <a
                            href="https://sites.google.com/andrew.cmu.edu/tarrlab/people/michael-j-tarr">Michael Tarr<sup>*</sup></a> &emsp;&emsp; <a
                            href="https://www.cs.cmu.edu/~lwehbe/">Leila Wehbe<sup>*</sup></a> &emsp;&emsp; <a
                            href="https://www.cs.cmu.edu/~katef/">Katerina Fragkiadaki<sup>*</sup></a></h5>
                    <div class="w3-center">
                        <h5>Carnegie Mellon University</h5>
                    </div>
                    <div class="w3-center">
                        <sup>*</sup>Equal
                    </div>
                </div>

                <br>
                
                <div class="project-links">
                    <a href="" target="_blank" class="btn-paper" role="button">
                        <img src="images/paper.png" class="vertical-center-paper"> Paper
                    </a>
                    <a href="https://github.com/Gabesarch/brain-dissection" target="_blank" class="btn-code" role="button">
                        <img src="images/code.png" class="vertical-center-code"> Code
                    </a>
                    <a href="#citation" class="btn-citation" role="button">
                        <img src="images/googlescholar.png" class="vertical-center-cit"> Citation
                    </a>
                </div>

                <br>
                <spacer type="horizontal" width="5" height="5"> </spacer>
                <br>

                <!-- <div class="w3-display-container w3-row w3-white w3-margin-bottom w3-center">
                    <img src="images/Example_each_room_fast.gif" style="width:100%">
                </div> -->
                <hr>
                <div class="w3-center">
                    <h2>Abstract</h2>
                </div>
                <p align="justify">The alignment between deep neural network (DNN) features and cortical responses currently provides the most accurate
                quantitative explanation for higher visual areas. At
                the same time, these model features have been critiqued as uninterpretable explanations, trading one black box (the
                human brain) for another (a neural network). In this paper, we train networks to directly predict, from scratch, brain
                responses to images from a large-scale dataset of natural scenes. We then employ "network dissection" <a href="https://arxiv.org/abs/1704.05796">(Bau et al., 2017)</a>, 
                a method used for enhancing neural network interpretability by identifying and localizing the
                most significant features in images for individual units of a trained network, and which has been used to study category
                selectivity in the human brain <a href="https://www.biorxiv.org/content/10.1101/2022.03.16.484578v2">(Khosla & Wehbe, 2022)</a>. We adapt this approach to create a hypothesis-neutral model that is
                then used to explore the tuning properties of specific visual regions beyond category selectivity, which we call "brain
                dissection".</p>
                <br>
                <spacer type="horizontal" width="5" height="5"> </spacer>
                <br>
                <p align="justify">We use brain dissection to examine a range of ecologically important, intermediate properties, including
                depth, surface normals, curvature, and object relations and find consistent feature selectivity differences across
                sub-regions of the parietal, lateral, and ventral visual streams. For example, in the three scene-selective network we
                find that RSC prefers far depths and in-plane horizontal surface normals, while OPA and PPA prefer near and mid depths
                and vertical surface normals, indicating a change in the spatial coordinate system used for scene representations across
                RSC and OPA/PPA. Such findings contribute to a deeper, more fine-grained understanding of the functional characteristics
                of human visual cortex when viewing natural scenes.</p>
                <hr>
                
                <!-- </script> -->

                <!-- <div class="outer"> -->
                <!-- <div class="inner">
                    <img src="images/median_abs_depths_subject1.png" id="brain_image1" style="width:100%">
                </div>
                <div class="log">
                    <p>
                        Offset-relative: <span id="offsetX">0</span>
                    </p>
                </div> -->

                </section>


                <div class="w3-display-container w3-row w3-white w3-margin-bottom w3-center">
                    <h2>How does brain dissection work?</h2>
                    <p align="justify">
                    Inspired by <a href="https://www.biorxiv.org/content/10.1101/2022.03.16.484578v2">Khosla & Wehbe 2022</a>, brain dissection provides a hypothesis-neutral approach for identifying the most significant image features for
                    predicting the response of a specific voxel. </p>
                    <br>
                    <p align="justify">The method trains a convolutional neural network tailored to predict voxel
                    responses within a defined sub-region. By training a backbone network for this sub-region and incorporating a linear
                    readout for each voxel, the network learns to extract image features crucial for predicting each voxel
                    (<b>Figure A below</b>).</p>
                    <br>
                    <p align="justify">After training, we "dissect" the network by inputting held-out images and extracting regions that
                    the network considers most relevant for each voxel (<b>Figure B below</b>). Subsequently, we analyze properties of the
                    voxel-selective regions within the images.
                    </p>
                    <br>
                    <img src="images/Figure1_full_V7.png" style="width:100%">
                    <p> </p>
                    <br>
                    <spacer type="horizontal" width="100" height="50"> </spacer>
                    <br>
                    <!-- <p align="justify"><b>A. fMRI Response-Optimized Training Procedure.</b> All voxels in an ROI share a convolutional backbone. Each voxel is assigned a set of learnable spatial and feature weights. The voxel weights are applied to the output features of the backbone network to predict the voxel response for an input image. Training minimizes the mean squared error between the predicted and actual voxel response of NSD images.</p>
                    <p align="justify"><b>B. Dissection Procedure.</b> For each voxel in an ROI and test image, we obtain the voxel's selectivity binary mask by applying the voxel's feature weights to the output of the ROI-specific backbone and thresholding the resultant feature map. We examine the overlapping region between the mask and a measurement of interest (e.g., depth map).</p> -->
                </div>
                <hr>

                <div class="w3-display-container w3-row w3-white w3-margin-bottom w3-center">
                    <h2>Results</h2>
                    
                    <!-- <div class="inner">
                        <img src="images/median_abs_depths_subject1.png" id="brain_image1" style="width:100%">
                    </div>
                    <div class="log">
                        <p>
                            Depth: <span id="offsetX">0</span> meters
                        </p>
                    </div> -->

                </div>
                <h3>Absolute Depth</h3>
                <!-- The grid: four columns -->
                <div class="row">
                    <div class="column">
                        <div class="parentContainer">
                        <img src="images/median_abs_depths_subject1.png" alt="Nature" onclick="myFunction(this);" style="width:100%" id="depth1">
                        <!-- <div class="text-block">
                            <h4>Subject 1</h4>
                        </div> -->
                        <div class="centered">Subject 1</div>
                        </div>
                        
                    </div>
                    <div class="column">
                        <div class="parentContainer">
                        <img src="images/median_abs_depths_subject1.png" alt="Snow" onclick="myFunction(this);" style="width:100%" id="depth2">
                        <div class="centered">Subject 2</div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="parentContainer">
                        <img src="images/median_abs_depths_subject1.png" alt="Mountains" onclick="myFunction(this);" style="width:100%" id="depth3">
                        <div class="centered">Subject 3</div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="parentContainer">
                        <img src="images/median_abs_depths_subject1.png" alt="Lights" onclick="myFunction(this);" style="width:100%" id="depth4">
                        <div class="centered">Subject 4</div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="column">
                        <div class="parentContainer">
                            <img src="images/median_abs_depths_subject1.png" alt="Nature" onclick="myFunction(this);" style="width:100%"
                                id="depth1">
                            <!-- <div class="text-block">
                                            <h4>Subject 1</h4>
                                        </div> -->
                            <div class="centered">Subject 5</div>
                        </div>
                
                    </div>
                    <div class="column">
                        <div class="parentContainer">
                            <img src="images/median_abs_depths_subject1.png" alt="Snow" onclick="myFunction(this);" style="width:100%"
                                id="depth2">
                            <div class="centered">Subject 6</div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="parentContainer">
                            <img src="images/median_abs_depths_subject1.png" alt="Mountains" onclick="myFunction(this);"
                                style="width:100%" id="depth3">
                            <div class="centered">Subject 7</div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="parentContainer">
                            <img src="images/median_abs_depths_subject1.png" alt="Lights" onclick="myFunction(this);" style="width:100%"
                                id="depth4">
                            <div class="centered">Subject 8</div>
                        </div>
                    </div>
                </div>


                <!-- <br>
                <spacer type="horizontal" width="5" height="5"> </spacer>
                <br> -->

                <div class="inner">
                    <!-- <img src="images/median_abs_depths_subject1.png" id="brain_image1" style="width:100%"> -->
                    <span onclick="this.parentElement.style.display='none'" class="closebtn">&times;</span>
                    <img id="expandedImg" style="width:100%">
                    <div id="imgtext"></div>
                    <div class="log">
                        <p>
                            Depth: <span id="offsetX">0</span> meters
                        </p>
                    </div>
                </div>
                

                <!-- <div class="container">
                    <span onclick="this.parentElement.style.display='none'" class="closebtn">&times;</span>
                    <img id="expandedImg" style="width:100%">
                    <div id="imgtext"></div>
                </div> -->
                <hr>

                <section id="citation">
                    <h3>Citation</h3>
                    <div class="cit_cont">
                        <pre style="background-color:#F5F5F5;"><code><font size="-1">@inproceedings{sarch2023braindissect,
            title = "Brain Dissection: fMRI-trained Networks Reveal Spatial Selectivity in the Processing of Natural Images",
            author = "Sarch, Gabriel H. and Tarr, Michael J. and Wehbe, Leila and Fragkiadaki, Katerina", 
            booktitle = "bioRxiv",
            year = "2023"}</font></code></pre>
                    </div>
                </section>
                <hr>

                <!-- end paper container -->

            </div><!-- End Grid -->
        </div><!-- End Page Container -->

<!-- Taken from view-source:https://developer.mozilla.org/en-US/docs/Web/CSS/CSSOM_View/Coordinate_systems#example -->
<!-- <script src="data/median_abs_depths_subject1.js"></script> -->
<script type="module">
    import { array } from './data/median_abs_depths_subject1.js'
    let inner = document.querySelector(".inner");
    let log = document.querySelector(".log");

    // import { array1 } from 'data/median_abs_depths_subject1.js'

    function setCoords(e, type) {
        
        const idX = `${type}X`;
        const idY = `${type}Y`;

        var xcoord = e[idX];
        var ycoord = e[idY];

        // var array = [
        //     ['Work', 9],
        //     ['Eat', 1],
        //     ['Commute', 2],
        //     ['Play Game', 1],
        //     ['Sleep', 7]
        // ];
        var img = document.getElementById('expandedImg');
        //or however you get a handle to the IMG
        // var width = img.clientWidth;
        // var height = img.clientHeight;
        // var scale_width = 512 / img.clientWidth;
        // var scale_height = 512 / img.clientHeight;
        var ycoord_adjusted = Math.max(0, Math.min(parseInt(ycoord * (512 / img.clientHeight)), 512 - 1));
        var xcoord_adjusted = Math.max(0, Math.min(parseInt(xcoord * (1124 / img.clientWidth)), 1124 - 1));

        var data = array[ycoord_adjusted][xcoord_adjusted]

        // document.getElementById(idX).innerText = e[idX];
        // document.getElementById(idY).innerText = e[idY];
        var data = Math.round(data * 1000) / 1000
        document.getElementById(idX).innerText = data;
        // document.getElementById(idY).innerText = ycoord;
    }

    function update(e) {
        setCoords(e, "offset");
        // setCoords(e, "client");
        // setCoords(e, "page");
        // setCoords(e, "screen");
    }

    inner.addEventListener("mouseenter", update, false);
    inner.addEventListener("mousemove", update, false);
    inner.addEventListener("mouseleave", update, false);

</script>

<script>
    function myFunction(imgs) {
        var expandImg = document.getElementById("expandedImg");
        var imgText = document.getElementById("imgtext");
        expandImg.src = imgs.src;
        imgText.innerHTML = imgs.alt;
        expandImg.parentElement.style.display = "block";
    }
</script>

</body>

</html>